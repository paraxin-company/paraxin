{% extends 'panel/paxi.html' %}

{% block ticket_page %}text-paraxin-c-200 font-bold{% endblock %}

{% block content %}
<h1 class="text-paraxin-c-300 text-center my-4 font-tit text-2xl">صفحه‌ی تیکت ها</h1>
<div class="mt-1 mb-8 flex justify-end">
    <form action="" class="w-full sm:w-4/12">
        {% if search_text %}
        <div class="relative">
            <input class="simple-input pl-9" id="search" name="search" placeholder="search" required type="search" value="{{search_text}}">
            <div class="absolute left-2 top-3 text-gray-400 hover:cursor-pointer">
                <button type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                    </svg>
                </button>
            </div>
        </div>
        {% else %}
        <div class="relative">
            <input class="simple-input pl-9" id="search" name="search" placeholder="search" required type="search">
            <div class="absolute left-2 top-3 text-gray-400 hover:cursor-pointer">
                <button type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                    </svg>
                </button>
            </div>
        </div>
        {% endif %}
    </form>
</div>
{% if data.total %}
<table class="table">
    <thead class="table-head">
        <tr>
            <th scope="col" class="table-head-item">id</th>
            <th scope="col" class="table-head-item">date</th>
            <th scope="col" class="table-head-item">department</th>
            <th scope="col" class="table-head-item">title</th>
            <th scope="col" class="table-head-item">method</th>
        </tr>
    </thead>
    <tbody>
        {% for log in data%}
        <tr class="table-row">
            <th scope="row" class="text-paraxin-c-200">{{log.id}}</th>
            <td class="text-center py-1">{{log.time}}</td>
            <td class="text-center py-1">{{log.department}}</td>
            <td class="text-center py-1">{{log.title[:60]}} ..</td>
            <td class="text-center flex justify-center items-center py-1">
                <a class="p-1 text-green-500 cursor-pointer hover:text-green-700" title="Start conversation" href="{{url_for('paxi_answer_ticket', id_ticket=log.id)}}">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z" />
                    </svg>
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<div class="my-10 flex justify-center items-center">
    <ul class="pagination">
        {% if data.has_prev %}
            <li class="pagination-control">
                <a href="{{url_for('paxi_ticket', page=data.page-1)}}" aria-label="Previous">
                    <span>&laquo;</span>
                </a>
            </li>
        {% else %}
            <li class="pagination-control pagination-disable">
                <span>&laquo;</span>
            </li>
        {% endif %}

        {% for page in data.iter_pages() %}
            {% if page != data.page %}
                <li class="pagination-item"><a href="{{url_for('paxi_ticket', page=page)}}">{{page}}</a></li> 
            {% else %}
                <li class="pagination-item pagination-here"><a href="{{url_for('paxi_ticket', page=page)}}">{{page}}</a></li>
            {% endif %}
        {% endfor %}
        
        {% if data.has_next %}
            <li class="pagination-control">
                <a href="{{url_for('paxi_ticket', page=data.page+1)}}">
                    <span>&raquo;</span>
                </a>
            </li>
        {% else %}
            <li class="pagination-control pagination-disable">
                <span>&raquo;</span>
            </li>
        {% endif %}
    </ul>
</div>
{% else %}
    <p class="text-center alert alert-danger mt-5">محتوایی پیدا نشد</p>
{% endif %}
{% endblock %}